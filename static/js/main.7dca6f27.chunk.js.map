{"version":3,"sources":["couchdb.js","analyzer.js","App.js","reportWebVitals.js","index.js"],"names":["PouchDB","plugin","PouchDBFind","CouchDBWrapper","name","url","index","this","dbRemote","skip_setup","dbLocal","auto_compaction","revs_limit","indexed","a","createIndex","syncDB","doSync","info","host","Error","remote","replicate","from","batch_size","batches_limit","input","checkDB","post","res","put","query","allDocs","normalize","offset","total_rows","rows","map","val","doc","find","docs","length","id","get","TYPE_KEY","NULL","UNDEFINED","ARRAY","BOOLEAN","NUMBER","STRING","OBJECT","DATA_TYPES","key","getType","variable","undefined","Array","isArray","doAnalyze","list","finalMap","getOrCreate","keys","updateMap","obj","Object","type","item","analyze","values","indexOf","rec","console","log","FETCH_STATUS","DATA_TYPES_NULL_OR_UNDEFINED","filter","DATA_TYPES_NON_NULL_NON_UNDEFINED","fetchData","dbName","dbUrl","batchLength","updateData","db","allData","tmpData","skip","selector","limit","useInput","initialValue","useState","value","setValue","onChange","e","target","AnalyzerContext","React","createContext","useAnalyzerContext","useContext","AnalyzerProvider","children","analyzer","status","setStatus","lastError","setLastError","data","setData","analysisResult","setAnalysisResult","newData","newAnalysis","error","useAnalyzer","Provider","Input","label","inputProps","className","htmlFor","Button","classType","onClick","buttonProps","preventDefault","Form","placeholder","min","max","trim","Number","disabled","AnalysisReportLoading","dataLength","role","style","width","height","AnalysisReportRow","variableName","level","dataTypeKeys","dataTypeKeysNonNullNonUndefined","otherKeys","sort","spaces","_","isMultitype","reduce","sum","isHasNullOrUndefined","rowStyle","rowNote","dataType","borderLeft","otherKey","AnalysisReport","scope","AnalysisReportContainer","message","App","minHeight","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7dca6f27.chunk.js","sourcesContent":["import PouchDBFind from \"pouchdb-find\";\nimport PouchDB from \"pouchdb\";\nPouchDB.plugin(PouchDBFind);\n\nclass CouchDBWrapper {\n  constructor(name, url, index) {\n    this.dbRemote = new PouchDB(`${url}/${name}`, { skip_setup: true });\n    this.dbLocal = new PouchDB(name, {\n      auto_compaction: true,\n      revs_limit: 2,\n    });\n    this.index = index;\n    this.indexed = false;\n  }\n\n  async createIndex() {\n    await this.dbLocal.createIndex({\n      index: this.index,\n    });\n    await this.dbRemote.createIndex({\n      index: this.index,\n    });\n\n    this.indexed = true;\n    await this.syncDB();\n  }\n\n  async checkDB(doSync) {\n    const info = await this.dbRemote.info();\n\n    if (!info.host) {\n      throw new Error(\"database is not connected\");\n    }\n\n    if (this.index && !this.indexed) {\n      await this.createIndex();\n    }\n\n    let remote = null;\n    if (doSync) {\n      remote = await this.syncDB();\n    }\n\n    return { info, remote };\n  }\n\n  async syncDB() {\n    return this.dbLocal.replicate.from(this.dbRemote, {\n      batch_size: 1000,\n      batches_limit: 2,\n    });\n  }\n\n  async create(input) {\n    try {\n      await this.checkDB(false);\n      const res = await this.dbRemote.post(input);\n      await this.syncDB();\n\n      return res;\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  async update(input) {\n    try {\n      await this.checkDB(false);\n      const res = await this.dbRemote.put(input);\n      await this.syncDB();\n\n      return res;\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  async list(query) {\n    try {\n      await this.checkDB(true);\n      const res = await this.dbLocal.allDocs(query);\n      const normalize = {\n        offset: res.offset,\n        total_rows: res.total_rows,\n        rows: res.rows.map((val) => val.doc),\n      };\n\n      return normalize;\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  async find(query) {\n    try {\n      await this.checkDB(true);\n      const res = await this.dbLocal.find(query);\n      const normalize = {\n        total_rows: res.docs.length,\n        rows: res.docs,\n      };\n\n      return normalize;\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  async get(id) {\n    try {\n      await this.checkDB(true);\n      return this.dbLocal.get(id);\n    } catch (err) {\n      throw err;\n    }\n  }\n}\nexport default CouchDBWrapper;\n","export const TYPE_KEY = {\n  NULL: \"___null\",\n  UNDEFINED: \"___undefined\",\n  ARRAY: \"___array\",\n  BOOLEAN: \"___boolean\",\n  NUMBER: \"___number\",\n  STRING: \"___string\",\n  OBJECT: \"___object\",\n};\n\nexport const DATA_TYPES = [\n  { name: \"Null\", key: TYPE_KEY.NULL },\n  { name: \"Undefined\", key: TYPE_KEY.UNDEFINED },\n  { name: \"Array\", key: TYPE_KEY.ARRAY },\n  { name: \"Boolean\", key: TYPE_KEY.BOOLEAN },\n  { name: \"Number\", key: TYPE_KEY.NUMBER },\n  { name: \"String\", key: TYPE_KEY.STRING },\n  { name: \"Object\", key: TYPE_KEY.OBJECT },\n];\n\nfunction getType(variable) {\n  if (variable === null) {\n    return TYPE_KEY.NULL;\n  } else if (variable === undefined) {\n    return TYPE_KEY.UNDEFINED;\n  } else if (Array.isArray(variable)) {\n    return TYPE_KEY.ARRAY;\n  } else {\n    return `___${typeof variable}`;\n  }\n}\n\nexport function doAnalyze(list) {\n  const finalMap = {};\n\n  function getOrCreate(keys) {\n    let res = finalMap;\n    for (let key of keys) {\n      if (!res[key]) {\n        res[key] = {};\n      }\n      res = res[key];\n    }\n    return res;\n  }\n\n  function updateMap(keys, obj) {\n    for (let key of Object.keys(obj)) {\n      getOrCreate([...keys, key]);\n      const type = getType(obj[key]);\n      if (type === TYPE_KEY.ARRAY) {\n        for (let item of obj[key]) {\n          updateMap([...keys, key], item);\n        }\n      } else if (type === TYPE_KEY.OBJECT) {\n        updateMap([...keys, key], obj[key]);\n      }\n    }\n  }\n\n  function analyze(keys, finalMap, obj) {\n    for (let key of Object.keys(finalMap)) {\n      if (Object.values(TYPE_KEY).indexOf(key) >= 0) continue;\n      const rec = getOrCreate([...keys, key]);\n      const type = getType(obj[key]);\n      if (rec[type]) rec[type]++;\n      else rec[type] = 1;\n      if (type === TYPE_KEY.ARRAY) {\n        for (let item of obj[key]) {\n          analyze([...keys, key], finalMap[key], item);\n        }\n      } else if (type === TYPE_KEY.OBJECT) {\n        analyze([...keys, key], finalMap[key], obj[key]);\n      }\n    }\n  }\n\n  // Generate final map\n  for (let obj of list) {\n    updateMap([], obj);\n  }\n  console.log(finalMap);\n\n  for (let obj of list) {\n    analyze([], finalMap, obj);\n  }\n\n  return finalMap;\n}\n","import React, { useContext, useState } from \"react\";\nimport CouchDBWrapper from \"./couchdb\";\nimport { DATA_TYPES, doAnalyze, TYPE_KEY } from \"./analyzer\";\n\nconst FETCH_STATUS = {\n  PENDING: \"PENDING\",\n  LOADING: \"LOADING\",\n  SUCCESS: \"SUCCESS\",\n  FAILED: \"FAILED\",\n};\n\nconst DATA_TYPES_NULL_OR_UNDEFINED = DATA_TYPES.filter(\n  ({ key }) => key === TYPE_KEY.NULL || key === TYPE_KEY.UNDEFINED\n);\nconst DATA_TYPES_NON_NULL_NON_UNDEFINED = DATA_TYPES.filter(\n  ({ key }) => key !== TYPE_KEY.NULL && key !== TYPE_KEY.UNDEFINED\n);\n\nasync function fetchData(dbName, dbUrl, batchLength, updateData) {\n  const db = new CouchDBWrapper(dbName, dbUrl);\n  let allData = [];\n  let tmpData = [];\n  let skip = 0;\n  do {\n    const res = await db.find({\n      selector: {},\n      limit: batchLength,\n      skip,\n    });\n    tmpData = res.rows;\n    skip += batchLength;\n    // eslint-disable-next-line no-loop-func\n    allData = [...allData, ...tmpData];\n    updateData(allData);\n  } while (tmpData.length === batchLength);\n  return allData;\n}\n\nfunction useInput(initialValue) {\n  const [value, setValue] = useState(initialValue);\n  return {\n    value,\n    onChange: (e) => {\n      setValue(e.target.value);\n    },\n  };\n}\n\nfunction useAnalyzer() {\n  const [status, setStatus] = useState(FETCH_STATUS.PENDING);\n  const [lastError, setLastError] = useState(null);\n  const [data, setData] = useState([]);\n  const [analysisResult, setAnalysisResult] = useState([]);\n\n  async function analyze({ dbUrl, dbName, batchLength }) {\n    setStatus(FETCH_STATUS.LOADING);\n    try {\n      const newData = await fetchData(dbName, dbUrl, batchLength, setData);\n      const newAnalysis = await doAnalyze(newData);\n      setData(newData);\n      setAnalysisResult(newAnalysis);\n      setStatus(FETCH_STATUS.SUCCESS);\n    } catch (err) {\n      setStatus(FETCH_STATUS.FAILED);\n      setLastError(err);\n      console.error(err);\n    }\n  }\n\n  return {\n    data,\n    analysisResult,\n    status,\n    lastError,\n    analyze,\n  };\n}\n\nconst AnalyzerContext = React.createContext();\n\nfunction useAnalyzerContext() {\n  const analyzer = useContext(AnalyzerContext);\n  return analyzer;\n}\n\nfunction AnalyzerProvider({ children }) {\n  const analyzer = useAnalyzer();\n  return (\n    <AnalyzerContext.Provider value={analyzer}>\n      {children}\n    </AnalyzerContext.Provider>\n  );\n}\n\nfunction Input({ id, label, ...inputProps }) {\n  return (\n    <div className=\"form-group mb-3\">\n      <label htmlFor={id}>{label}</label>\n      <input className=\"form-control\" id={id} {...inputProps} />\n    </div>\n  );\n}\n\nfunction Button({ label, classType = \"primary\", onClick, ...buttonProps }) {\n  function handleClick(e) {\n    e.preventDefault();\n    onClick(e);\n  }\n  return (\n    <button\n      onClick={handleClick}\n      className={`btn btn-${classType}`}\n      {...buttonProps}\n    >\n      {label}\n    </button>\n  );\n}\n\nfunction Form() {\n  const { analyze, status } = useAnalyzerContext();\n  const dbUrl = useInput(\"\");\n  const dbName = useInput(\"\");\n  const batchLength = useInput(1000);\n  function handleAnalyze() {\n    analyze({\n      dbUrl: dbUrl.value.trim(),\n      dbName: dbName.value.trim(),\n      batchLength: Number(batchLength.value),\n    });\n  }\n  function isValid() {\n    return (\n      dbUrl.value &&\n      dbName.value &&\n      Number(batchLength.value) > 0 &&\n      Number(batchLength.value) <= 1000\n    );\n  }\n  return (\n    <div className=\"mb-5\">\n      <form>\n        <h3 className=\"mb-4\">Please insert your couchdb credentials</h3>\n        <Input\n          id=\"host\"\n          label=\"Database URL & Credential\"\n          placeholder=\"https://<usernmae>:<password>@<host>:<port>\"\n          {...dbUrl}\n        />\n        <Input\n          id=\"db-name\"\n          label=\"Database Name\"\n          {...dbName}\n          placeholder=\"i.e fligth_schedules\"\n        />\n        <Input\n          id=\"batch-length\"\n          label=\"Request Batch Length\"\n          placeholder=\"1000\"\n          type=\"number\"\n          min=\"0\"\n          max=\"1000\"\n          {...batchLength}\n        />\n        <Button\n          type=\"submit\"\n          label=\"Analyze\"\n          onClick={handleAnalyze}\n          disabled={status === FETCH_STATUS.LOADING || !isValid()}\n        />\n      </form>\n      <hr />\n    </div>\n  );\n}\n\nfunction AnalysisReportLoading({ dataLength }) {\n  return (\n    <div className=\"d-flex justify-content-center align-items-center\">\n      <div className=\"py-5 d-flex flex-column justify-content-center align-items-center\">\n        <div\n          className=\"spinner-grow text-primary mb-3\"\n          role=\"status\"\n          style={{ width: 50, height: 50 }}\n        ></div>\n        <span className=\"mb-1 badge bg-primary fs-6 text px-3\">\n          Doing Science ...\n        </span>\n        <span>{dataLength} row[s] retrieved</span>\n      </div>\n    </div>\n  );\n}\n\nfunction AnalysisReportRow({ variableName, data, level = 0 }) {\n  const dataTypeKeys = DATA_TYPES.map(({ key }) => key);\n  const dataTypeKeysNonNullNonUndefined = DATA_TYPES_NON_NULL_NON_UNDEFINED.map(\n    ({ key }) => key\n  );\n  const otherKeys = Object.keys(data)\n    .filter((key) => dataTypeKeys.indexOf(key) < 0)\n    .sort();\n\n  const spaces = [...Array(level)].map((_, index) => (\n    <span key={index}>&nbsp; &nbsp; &nbsp;</span>\n  ));\n\n  // Check if data has multiple types other than null and undefined\n  const isMultitype =\n    dataTypeKeysNonNullNonUndefined.reduce(\n      (sum, key) => (!data[key] ? sum : sum + 1),\n      0\n    ) > 1;\n\n  const isHasNullOrUndefined =\n    data[TYPE_KEY.NULL] > 0 || data[TYPE_KEY.UNDEFINED] > 0;\n\n  const rowStyle = isMultitype\n    ? \"table-danger\"\n    : isHasNullOrUndefined\n    ? \"table-warning\"\n    : \"\";\n\n  const rowNote = isMultitype\n    ? \"Has several datatypes\"\n    : isHasNullOrUndefined\n    ? \"Contains null or undefined\"\n    : \"\";\n\n  return (\n    <>\n      <tr className={rowStyle}>\n        <td>\n          {spaces}\n          <span>{variableName}</span>\n        </td>\n        {DATA_TYPES_NULL_OR_UNDEFINED.map((dataType, index) => (\n          <td\n            key={dataType.key}\n            className=\"text-center\"\n            style={{ borderLeft: index === 0 ? \"2px solid black\" : 0 }}\n          >\n            {data[dataType.key] || 0}\n          </td>\n        ))}\n        {DATA_TYPES_NON_NULL_NON_UNDEFINED.map((dataType, index) => (\n          <td\n            key={dataType.key}\n            className=\"text-center\"\n            style={{ borderLeft: index === 0 ? \"2px solid black\" : 0 }}\n          >\n            {data[dataType.key] || 0}\n          </td>\n        ))}\n        <td\n          className=\"text-center text-small\"\n          style={{ borderLeft: \"2px solid black\" }}\n        >\n          <small>{rowNote}</small>\n        </td>\n      </tr>\n      {otherKeys.map((otherKey) => (\n        <AnalysisReportRow\n          key={otherKey}\n          variableName={otherKey}\n          data={data[otherKey]}\n          level={level + 1}\n        />\n      ))}\n    </>\n  );\n}\n\nfunction AnalysisReport({ analysisResult, dataLength }) {\n  return (\n    <>\n      <div>{dataLength} row[s] analyzed</div>\n      <table className=\"table table-hover table-responsive\">\n        <thead>\n          <tr>\n            <th scope=\"col\">Key</th>\n            {DATA_TYPES_NULL_OR_UNDEFINED.map((dataType, index) => (\n              <th\n                key={dataType.key}\n                scope=\"col\"\n                className=\"text-center\"\n                style={{ borderLeft: index === 0 ? \"2px solid black\" : 0 }}\n              >\n                {dataType.name}\n              </th>\n            ))}\n            {DATA_TYPES_NON_NULL_NON_UNDEFINED.map((dataType, index) => (\n              <th\n                key={dataType.key}\n                scope=\"col\"\n                className=\"text-center\"\n                style={{ borderLeft: index === 0 ? \"2px solid black\" : 0 }}\n              >\n                {dataType.name}\n              </th>\n            ))}\n            <th\n              scope=\"col\"\n              className=\"text-center\"\n              style={{ borderLeft: \"2px solid black\" }}\n            >\n              Note\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          {Object.keys(analysisResult)\n            .sort()\n            .map((key) => (\n              <AnalysisReportRow\n                key={key}\n                variableName={key}\n                data={analysisResult[key]}\n              />\n            ))}\n        </tbody>\n      </table>\n    </>\n  );\n}\n\nfunction AnalysisReportContainer() {\n  const { analysisResult, status, lastError, data } = useAnalyzerContext();\n  if (status === FETCH_STATUS.PENDING) return null;\n  return (\n    <div className=\"mb-5\">\n      <div>\n        <h3 className=\"mb-4\">\n          {status === FETCH_STATUS.LOADING\n            ? \"Analyzing Report\"\n            : \"Analysis Report\"}\n        </h3>\n        {status === FETCH_STATUS.LOADING && (\n          <div>\n            <AnalysisReportLoading dataLength={data.length} />\n          </div>\n        )}\n        {status === FETCH_STATUS.SUCCESS && (\n          <AnalysisReport\n            analysisResult={analysisResult}\n            dataLength={data.length}\n          />\n        )}\n        {status === FETCH_STATUS.FAILED && (\n          <div className=\"alert alert-danger\" role=\"alert\">\n            Something went wrong! Please recheck your credentials or connections\n            <br />\n            {lastError?.message}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction App() {\n  return (\n    <div className=\"p-5 bg-light min-vh-100\">\n      <div className=\"p-5 shadow-sm rounded bg-white h-100\">\n        <div className=\"pt-2 sticky-top bg-white\">\n          <h1>ePurist</h1>\n          <span>CouchDB healthchecker</span>\n          <hr className=\"mb-5\" />\n        </div>\n        <AnalyzerProvider>\n          <Form />\n          <AnalysisReportContainer />\n        </AnalyzerProvider>\n        <div style={{ minHeight: \"100vh\" }}></div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}