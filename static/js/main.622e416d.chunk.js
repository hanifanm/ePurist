(this["webpackJsonpe-purist"]=this["webpackJsonpe-purist"]||[]).push([[0],{30:function(e,t){},39:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),c=n(20),s=n.n(c),i=n(8),u=n(10),o=n(19),l=n(1),b=n.n(l),h=n(13),d=n(7),j=n(21),f=n(22),p=n(23),v=n(16);v.a.plugin(p.a);var O=function(){function e(t,n,r){Object(j.a)(this,e),this.dbRemote=new v.a("".concat(n,"/").concat(t),{skip_setup:!0}),this.dbLocal=new v.a(t,{auto_compaction:!0,revs_limit:2}),this.index=r,this.indexed=!1}return Object(f.a)(e,[{key:"createIndex",value:function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbLocal.createIndex({index:this.index});case 2:return e.next=4,this.dbRemote.createIndex({index:this.index});case 4:return this.indexed=!0,e.next=7,this.syncDB();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkDB",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbRemote.info();case 2:if((n=e.sent).host){e.next=5;break}throw new Error("database is not connected");case 5:if(!this.index||this.indexed){e.next=8;break}return e.next=8,this.createIndex();case 8:if(r=null,!t){e.next=13;break}return e.next=12,this.syncDB();case 12:r=e.sent;case 13:return e.abrupt("return",{info:n,remote:r});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"syncDB",value:function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dbLocal.replicate.from(this.dbRemote,{batch_size:1e3,batches_limit:2}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!1);case 3:return e.next=5,this.dbRemote.post(t);case 5:return n=e.sent,e.next=8,this.syncDB();case 8:return e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!1);case 3:return e.next=5,this.dbRemote.put(t);case 5:return n=e.sent,e.next=8,this.syncDB();case 8:return e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"list",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.next=5,this.dbLocal.allDocs(t);case 5:return n=e.sent,r={offset:n.offset,total_rows:n.total_rows,rows:n.rows.map((function(e){return e.doc}))},e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.next=5,this.dbLocal.find(t);case 5:return n=e.sent,r={total_rows:n.docs.length,rows:n.docs},e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.abrupt("return",this.dbLocal.get(t));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),x=n(12),m={NULL:"___null",UNDEFINED:"___undefined",ARRAY:"___array",BOOLEAN:"___boolean",NUMBER:"___number",STRING:"___string",OBJECT:"___object"},y=[{name:"Null",key:m.NULL},{name:"Undefined",key:m.UNDEFINED},{name:"Array",key:m.ARRAY},{name:"Boolean",key:m.BOOLEAN},{name:"Number",key:m.NUMBER},{name:"String",key:m.STRING},{name:"Object",key:m.OBJECT}];function k(e){return null===e?m.NULL:void 0===e?m.UNDEFINED:Array.isArray(e)?m.ARRAY:"___".concat(typeof e)}function N(e){var t={};function n(e){var n,r=t,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;r[c]||(r[c]={}),r=r[c]}}catch(s){a.e(s)}finally{a.f()}return r}function r(e,t){for(var a=0,c=Object.keys(t);a<c.length;a++){var s=c[a];n([].concat(Object(i.a)(e),[s]));var u=k(t[s]);if(u===m.ARRAY){var o,l=Object(x.a)(t[s]);try{for(l.s();!(o=l.n()).done;){var b=o.value;r([].concat(Object(i.a)(e),[s]),b)}}catch(h){l.e(h)}finally{l.f()}}else u===m.OBJECT&&r([].concat(Object(i.a)(e),[s]),t[s])}}function a(e,t,r){for(var c=0,s=Object.keys(t);c<s.length;c++){var u=s[c];if(!(Object.values(m).indexOf(u)>=0)){var o=n([].concat(Object(i.a)(e),[u])),l=k(r[u]);if(o[l]?o[l]++:o[l]=1,l===m.ARRAY){var b,h=Object(x.a)(r[u]);try{for(h.s();!(b=h.n()).done;){var d=b.value;a([].concat(Object(i.a)(e),[u]),t[u],d)}}catch(j){h.e(j)}finally{h.f()}}else l===m.OBJECT&&a([].concat(Object(i.a)(e),[u]),t[u],r[u])}}}var c,s=Object(x.a)(e);try{for(s.s();!(c=s.n()).done;){r([],c.value)}}catch(b){s.e(b)}finally{s.f()}console.log(t);var u,o=Object(x.a)(e);try{for(o.s();!(u=o.n()).done;){var l=u.value;a([],t,l)}}catch(b){o.e(b)}finally{o.f()}return t}var w=n(0),g="PENDING",_="LOADING",D="SUCCESS",L="FAILED";function R(e,t,n,r){return E.apply(this,arguments)}function E(){return(E=Object(d.a)(b.a.mark((function e(t,n,r,a){var c,s,u,o,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=new O(t,n),s=[],u=[],o=0;case 4:return e.next=6,c.find({selector:{},limit:r,skip:o});case 6:l=e.sent,u=l.rows,o+=r,s=[].concat(Object(i.a)(s),Object(i.a)(u)),a(s);case 11:if(u.length===r){e.next=4;break}case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){var t=Object(r.useState)(e),n=Object(h.a)(t,2),a=n[0],c=n[1];return{value:a,onChange:function(e){c(e.target.value)}}}var A=a.a.createContext();function C(){return Object(r.useContext)(A)}function U(e){var t=e.children,n=function(){var e=Object(r.useState)(g),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(h.a)(c,2),i=s[0],u=s[1],o=Object(r.useState)([]),l=Object(h.a)(o,2),j=l[0],f=l[1],p=Object(r.useState)([]),v=Object(h.a)(p,2),O=v[0],x=v[1];function m(){return(m=Object(d.a)(b.a.mark((function e(t){var n,r,c,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dbUrl,r=t.dbName,c=t.batchLength,a(_),e.prev=2,e.next=5,R(r,n,c,f);case 5:return s=e.sent,e.next=8,N(s);case 8:i=e.sent,f(s),x(i),a(D),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(2),a(L),u(e.t0),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,14]])})))).apply(this,arguments)}return{data:j,analysisResult:O,status:n,lastError:i,analyze:function(e){return m.apply(this,arguments)}}}();return Object(w.jsx)(A.Provider,{value:n,children:t})}function I(e){var t=e.id,n=e.label,r=Object(o.a)(e,["id","label"]);return Object(w.jsxs)("div",{className:"form-group mb-3",children:[Object(w.jsx)("label",{htmlFor:t,children:n}),Object(w.jsx)("input",Object(u.a)({className:"form-control",id:t},r))]})}function S(e){var t=e.label,n=e.classType,r=void 0===n?"primary":n,a=e.onClick,c=Object(o.a)(e,["label","classType","onClick"]);return Object(w.jsx)("button",Object(u.a)(Object(u.a)({onClick:function(e){e.preventDefault(),a(e)},className:"btn btn-".concat(r)},c),{},{children:t}))}function F(){var e=C(),t=e.analyze,n=e.status,r=B(""),a=B(""),c=B(1e3);return Object(w.jsxs)("div",{className:"mb-5",children:[Object(w.jsxs)("form",{children:[Object(w.jsx)("h3",{className:"mb-4",children:"Please insert your couchdb creadentials"}),Object(w.jsx)(I,Object(u.a)({id:"host",label:"Database URL & Credential",placeholder:"https://<usernmae>:<password>@<host>:<port>"},r)),Object(w.jsx)(I,Object(u.a)(Object(u.a)({id:"db-name",label:"Database Name"},a),{},{placeholder:"i.e fligth_schedules"})),Object(w.jsx)(I,Object(u.a)({id:"batch-length",label:"Request Batch Length",placeholder:"1000",type:"number",min:"0",max:"1000"},c)),Object(w.jsx)(S,{type:"submit",label:"Analyze",onClick:function(){t({dbUrl:r.value.trim(),dbName:a.value.trim(),batchLength:Number(c.value)})},disabled:n===_||!(r.value&&a.value&&Number(c.value)>0&&Number(c.value)<=1e3)})]}),Object(w.jsx)("hr",{})]})}function T(e){var t=e.dataLength;return Object(w.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:Object(w.jsxs)("div",{className:"py-5 d-flex flex-column justify-content-center align-items-center",children:[Object(w.jsx)("div",{className:"spinner-grow text-primary mb-3",role:"status",style:{width:50,height:50}}),Object(w.jsx)("span",{className:"mb-1 badge bg-primary fs-6 text px-3",children:"Doing Science ..."}),Object(w.jsxs)("span",{children:[t," row[s] retrieved"]})]})})}function P(e){var t=e.variableName,n=e.data,r=e.level,a=void 0===r?0:r,c=y.map((function(e){return e.key})),s=c.filter((function(e){return e!==m.NULL&&e!==m.UNDEFINED})),u=Object.keys(n).filter((function(e){return c.indexOf(e)<0})).sort(),o=Object(i.a)(Array(a)).map((function(e,t){return Object(w.jsx)("span",{children:"  "},t)})),l=s.reduce((function(e,t){return n[t]?e+1:e}),0)>1,b=n[m.NULL]>0||n[m.UNDEFINED]>0,h=l?"table-danger":b?"table-warning":"";return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("tr",{className:h,children:[Object(w.jsxs)("td",{children:[o,Object(w.jsx)("span",{children:t})]}),y.map((function(e){return Object(w.jsx)("td",{children:n[e.key]||0},e.key)}))]}),u.map((function(e){return Object(w.jsx)(P,{variableName:e,data:n[e],level:a+1},e)}))]})}function J(e){var t=e.analysisResult;return Object(w.jsxs)("table",{className:"table table-hover",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{scope:"col",children:"Key"}),y.map((function(e){return Object(w.jsx)("th",{scope:"col",children:e.name},e.key)}))]})}),Object(w.jsx)("tbody",{children:Object.keys(t).sort().map((function(e){return Object(w.jsx)(P,{variableName:e,data:t[e]},e)}))})]})}function Y(){var e=C(),t=e.analysisResult,n=e.status,r=e.lastError,a=e.data;return n===g?null:Object(w.jsx)("div",{className:"mb-5",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"mb-4",children:"Analysis Report"}),n===_&&Object(w.jsx)("div",{children:Object(w.jsx)(T,{dataLength:a.length})}),n===D&&Object(w.jsx)("pre",{children:Object(w.jsx)(J,{analysisResult:t})}),n===L&&Object(w.jsxs)("div",{className:"alert alert-danger",role:"alert",children:["Something went wrong! Please recheck your credentials or connections",Object(w.jsx)("br",{}),null===r||void 0===r?void 0:r.message]})]})})}var z=function(){return Object(w.jsx)("div",{className:"p-5 bg-light min-vh-100",children:Object(w.jsxs)("div",{className:"p-5 shadow-sm rounded bg-white h-100",children:[Object(w.jsxs)("div",{className:"pt-2 sticky-top bg-white",children:[Object(w.jsx)("h1",{children:"ePurist"}),Object(w.jsx)("span",{children:"Couchdb healthchecker"}),Object(w.jsx)("hr",{className:"mb-5"})]}),Object(w.jsxs)(U,{children:[Object(w.jsx)(F,{}),Object(w.jsx)(Y,{})]}),Object(w.jsx)("div",{style:{minHeight:"100vh"}})]})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(38);s.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(z,{})}),document.getElementById("root")),G()}},[[39,1,2]]]);
//# sourceMappingURL=main.622e416d.chunk.js.map