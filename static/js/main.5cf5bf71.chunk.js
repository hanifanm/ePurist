(this["webpackJsonpe-purist"]=this["webpackJsonpe-purist"]||[]).push([[0],{30:function(e,t){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),c=n(20),s=n.n(c),i=n(8),l=n(10),u=n(19),o=n(1),b=n.n(o),h=n(13),d=n(7),j=n(21),f=n(22),p=n(23),x=n(16);x.a.plugin(p.a);var v=function(){function e(t,n,r){Object(j.a)(this,e),this.dbRemote=new x.a("".concat(n,"/").concat(t),{skip_setup:!0}),this.dbLocal=new x.a(t,{auto_compaction:!0,revs_limit:2}),this.index=r,this.indexed=!1}return Object(f.a)(e,[{key:"createIndex",value:function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbLocal.createIndex({index:this.index});case 2:return e.next=4,this.dbRemote.createIndex({index:this.index});case 4:return this.indexed=!0,e.next=7,this.syncDB();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkDB",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbRemote.info();case 2:if((n=e.sent).host){e.next=5;break}throw new Error("database is not connected");case 5:if(!this.index||this.indexed){e.next=8;break}return e.next=8,this.createIndex();case 8:if(r=null,!t){e.next=13;break}return e.next=12,this.syncDB();case 12:r=e.sent;case 13:return e.abrupt("return",{info:n,remote:r});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"syncDB",value:function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dbLocal.replicate.from(this.dbRemote,{batch_size:1e3,batches_limit:2}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!1);case 3:return e.next=5,this.dbRemote.post(t);case 5:return n=e.sent,e.next=8,this.syncDB();case 8:return e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!1);case 3:return e.next=5,this.dbRemote.put(t);case 5:return n=e.sent,e.next=8,this.syncDB();case 8:return e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"list",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.next=5,this.dbLocal.allDocs(t);case 5:return n=e.sent,r={offset:n.offset,total_rows:n.total_rows,rows:n.rows.map((function(e){return e.doc}))},e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.next=5,this.dbLocal.find(t);case 5:return n=e.sent,r={total_rows:n.docs.length,rows:n.docs},e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkDB(!0);case 3:return e.abrupt("return",this.dbLocal.get(t));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),O=n(12),m={NULL:"___null",UNDEFINED:"___undefined",ARRAY:"___array",BOOLEAN:"___boolean",NUMBER:"___number",STRING:"___string",OBJECT:"___object"},y=[{name:"Null",key:m.NULL},{name:"Undefined",key:m.UNDEFINED},{name:"Array",key:m.ARRAY},{name:"Boolean",key:m.BOOLEAN},{name:"Number",key:m.NUMBER},{name:"String",key:m.STRING},{name:"Object",key:m.OBJECT}];function k(e){return null===e?m.NULL:void 0===e?m.UNDEFINED:Array.isArray(e)?m.ARRAY:"___".concat(typeof e)}function N(e){var t={};function n(e){var n,r=t,a=Object(O.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;r[c]||(r[c]={}),r=r[c]}}catch(s){a.e(s)}finally{a.f()}return r}function r(e,t){for(var a=0,c=Object.keys(t);a<c.length;a++){var s=c[a];n([].concat(Object(i.a)(e),[s]));var l=k(t[s]);if(l===m.ARRAY){var u,o=Object(O.a)(t[s]);try{for(o.s();!(u=o.n()).done;){var b=u.value;r([].concat(Object(i.a)(e),[s]),b)}}catch(h){o.e(h)}finally{o.f()}}else l===m.OBJECT&&r([].concat(Object(i.a)(e),[s]),t[s])}}function a(e,t,r){for(var c=0,s=Object.keys(t);c<s.length;c++){var l=s[c];if(!(Object.values(m).indexOf(l)>=0)){var u=n([].concat(Object(i.a)(e),[l])),o=k(r[l]);if(u[o]?u[o]++:u[o]=1,o===m.ARRAY){var b,h=Object(O.a)(r[l]);try{for(h.s();!(b=h.n()).done;){var d=b.value;a([].concat(Object(i.a)(e),[l]),t[l],d)}}catch(j){h.e(j)}finally{h.f()}}else o===m.OBJECT&&a([].concat(Object(i.a)(e),[l]),t[l],r[l])}}}var c,s=Object(O.a)(e);try{for(s.s();!(c=s.n()).done;){r([],c.value)}}catch(b){s.e(b)}finally{s.f()}console.log(t);var l,u=Object(O.a)(e);try{for(u.s();!(l=u.n()).done;){var o=l.value;a([],t,o)}}catch(b){u.e(b)}finally{u.f()}return t}var g=n(0),w="PENDING",L="LOADING",D="SUCCESS",_="FAILED",R=y.filter((function(e){var t=e.key;return t===m.NULL||t===m.UNDEFINED})),E=y.filter((function(e){var t=e.key;return t!==m.NULL&&t!==m.UNDEFINED}));function B(e,t,n,r){return A.apply(this,arguments)}function A(){return(A=Object(d.a)(b.a.mark((function e(t,n,r,a){var c,s,l,u,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=new v(t,n),s=[],l=[],u=0;case 4:return e.next=6,c.find({selector:{},limit:r,skip:u});case 6:o=e.sent,l=o.rows,u+=r,s=[].concat(Object(i.a)(s),Object(i.a)(l)),a(s);case 11:if(l.length===r){e.next=4;break}case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){var t=Object(r.useState)(e),n=Object(h.a)(t,2),a=n[0],c=n[1];return{value:a,onChange:function(e){c(e.target.value)}}}var U=a.a.createContext();function I(){return Object(r.useContext)(U)}function S(e){var t=e.children,n=function(){var e=Object(r.useState)(w),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(h.a)(c,2),i=s[0],l=s[1],u=Object(r.useState)([]),o=Object(h.a)(u,2),j=o[0],f=o[1],p=Object(r.useState)([]),x=Object(h.a)(p,2),v=x[0],O=x[1];function m(){return(m=Object(d.a)(b.a.mark((function e(t){var n,r,c,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dbUrl,r=t.dbName,c=t.batchLength,a(L),f([]),e.prev=3,e.next=6,B(r,n,c,f);case 6:return s=e.sent,e.next=9,N(s);case 9:i=e.sent,f(s),O(i),a(D),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(3),a(_),l(e.t0),console.error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})))).apply(this,arguments)}return{data:j,analysisResult:v,status:n,lastError:i,analyze:function(e){return m.apply(this,arguments)}}}();return Object(g.jsx)(U.Provider,{value:n,children:t})}function F(e){var t=e.id,n=e.label,r=Object(u.a)(e,["id","label"]);return Object(g.jsxs)("div",{className:"form-group mb-3",children:[Object(g.jsx)("label",{htmlFor:t,children:n}),Object(g.jsx)("input",Object(l.a)({className:"form-control",id:t},r))]})}function T(e){var t=e.label,n=e.classType,r=void 0===n?"primary":n,a=e.onClick,c=Object(u.a)(e,["label","classType","onClick"]);return Object(g.jsx)("button",Object(l.a)(Object(l.a)({onClick:function(e){e.preventDefault(),a(e)},className:"btn btn-".concat(r)},c),{},{children:t}))}function P(){var e=I(),t=e.analyze,n=e.status,r=C(""),a=C(""),c=C(1e3);return Object(g.jsxs)("div",{className:"mb-5",children:[Object(g.jsxs)("form",{children:[Object(g.jsx)("h3",{className:"mb-4",children:"Please insert your couchdb credentials"}),Object(g.jsx)(F,Object(l.a)({id:"host",label:"Database URL & Credential",placeholder:"https://<usernmae>:<password>@<host>:<port>"},r)),Object(g.jsx)(F,Object(l.a)(Object(l.a)({id:"db-name",label:"Database Name"},a),{},{placeholder:"i.e fligth_schedules"})),Object(g.jsx)(F,Object(l.a)({id:"batch-length",label:"Request Batch Length",placeholder:"1000",type:"number",min:"0",max:"1000"},c)),Object(g.jsx)(T,{type:"submit",label:"Analyze",onClick:function(){t({dbUrl:r.value.trim(),dbName:a.value.trim(),batchLength:Number(c.value)})},disabled:n===L||!(r.value&&a.value&&Number(c.value)>0&&Number(c.value)<=1e3)})]}),Object(g.jsx)("hr",{})]})}function z(e){var t=e.dataLength;return Object(g.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:Object(g.jsxs)("div",{className:"py-5 d-flex flex-column justify-content-center align-items-center",children:[Object(g.jsx)("div",{className:"spinner-grow text-primary mb-3",role:"status",style:{width:50,height:50}}),Object(g.jsx)("span",{className:"mb-1 badge bg-primary fs-6 text px-3",children:"Doing Science ..."}),Object(g.jsxs)("span",{children:[t," row[s] retrieved"]})]})})}function J(e){var t=e.variableName,n=e.data,r=e.level,a=void 0===r?0:r,c=y.map((function(e){return e.key})),s=E.map((function(e){return e.key})),l=Object.keys(n).filter((function(e){return c.indexOf(e)<0})).sort(),u=Object(i.a)(Array(a)).map((function(e,t){return Object(g.jsx)("span",{children:"\xa0 \xa0 \xa0"},t)})),o=s.reduce((function(e,t){return n[t]?e+1:e}),0)>1,b=n[m.NULL]>0||n[m.UNDEFINED]>0,h=o?"table-danger":b?"table-warning":"",d=o?"Has several datatypes":b?"Contains null or undefined":"";return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("tr",{className:h,children:[Object(g.jsxs)("td",{children:[u,Object(g.jsx)("span",{children:t})]}),R.map((function(e,t){return Object(g.jsx)("td",{className:"text-center",style:{borderLeft:0===t?"2px solid black":0},children:n[e.key]||0},e.key)})),E.map((function(e,t){return Object(g.jsx)("td",{className:"text-center",style:{borderLeft:0===t?"2px solid black":0},children:n[e.key]||0},e.key)})),Object(g.jsx)("td",{className:"text-center text-small",style:{borderLeft:"2px solid black"},children:Object(g.jsx)("small",{children:d})})]}),l.map((function(e){return Object(g.jsx)(J,{variableName:e,data:n[e],level:a+1},e)}))]})}function Y(e){var t=e.analysisResult,n=e.dataLength;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{children:[n," row[s] analyzed"]}),Object(g.jsxs)("table",{className:"table table-hover table-responsive",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{scope:"col",children:"Key"}),R.map((function(e,t){return Object(g.jsx)("th",{scope:"col",className:"text-center",style:{borderLeft:0===t?"2px solid black":0},children:e.name},e.key)})),E.map((function(e,t){return Object(g.jsx)("th",{scope:"col",className:"text-center",style:{borderLeft:0===t?"2px solid black":0},children:e.name},e.key)})),Object(g.jsx)("th",{scope:"col",className:"text-center",style:{borderLeft:"2px solid black"},children:"Note"})]})}),Object(g.jsx)("tbody",{children:Object.keys(t).sort().map((function(e){return Object(g.jsx)(J,{variableName:e,data:t[e]},e)}))})]})]})}function G(){var e=I(),t=e.analysisResult,n=e.status,r=e.lastError,a=e.data;return n===w?null:Object(g.jsx)("div",{className:"mb-5",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{className:"mb-4",children:n===L?"Analyzing Report":"Analysis Report"}),n===L&&Object(g.jsx)("div",{children:Object(g.jsx)(z,{dataLength:a.length})}),n===D&&Object(g.jsx)(Y,{analysisResult:t,dataLength:a.length}),n===_&&Object(g.jsxs)("div",{className:"alert alert-danger",role:"alert",children:["Something went wrong! Please recheck your credentials or connections",Object(g.jsx)("br",{}),null===r||void 0===r?void 0:r.message]})]})})}var M=function(){return Object(g.jsx)("div",{className:"p-5 bg-light min-vh-100",children:Object(g.jsxs)("div",{className:"p-5 shadow-sm rounded bg-white h-100",children:[Object(g.jsxs)("div",{className:"pt-2 sticky-top bg-white",children:[Object(g.jsx)("h1",{children:"ePurist"}),Object(g.jsx)("span",{children:"CouchDB healthchecker"}),Object(g.jsx)("hr",{className:"mb-5"})]}),Object(g.jsxs)(S,{children:[Object(g.jsx)(P,{}),Object(g.jsx)(G,{})]}),Object(g.jsx)("div",{style:{minHeight:"100vh"}})]})})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(38),n(39);s.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(M,{})}),document.getElementById("root")),H()}},[[40,1,2]]]);
//# sourceMappingURL=main.5cf5bf71.chunk.js.map